(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,85917,e=>{"use strict";var t=e.i(43476),i=e.i(71645);class s{x;y;constructor(e,t){this.x=e,this.y=t}add(e){return new s(this.x+e.x,this.y+e.y)}sub(e){return new s(this.x-e.x,this.y-e.y)}mult(e){return new s(this.x*e,this.y*e)}div(e){return new s(this.x/e,this.y/e)}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){let e=this.mag();return e>0?this.div(e):new s(0,0)}limit(e){return this.mag()>e?this.normalize().mult(e):this}dist(e){let t=this.x-e.x,i=this.y-e.y;return Math.sqrt(t*t+i*i)}}class a{position;velocity;acceleration;genome;energy;age;isDead;maxSpeed;maxForce;senseRadius;size;reproUrge;constructor(e,t,i){this.position=new s(e,t),this.velocity=new s(Math.random()-.5,Math.random()-.5),this.acceleration=new s(0,0),this.genome=i||{speed:Math.random(),senseRadius:Math.random(),size:Math.random(),bravery:Math.random(),altruism:Math.random(),color:function(){let e="#";for(let t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}()},this.energy=100,this.age=0,this.isDead=!1,this.reproUrge=0,this.maxSpeed=2+4*this.genome.speed,this.maxForce=.1+.2*this.genome.speed,this.senseRadius=50+150*this.genome.senseRadius,this.size=5+15*this.genome.size}update(e,t,i,s){this.age++,this.reproUrge++;let a=.01*this.size+.01*this.maxSpeed+.001*this.senseRadius;if(this.energy-=a,this.energy<=0||this.age>2e3){this.isDead=!0;return}this.reproUrge>200&&this.energy>120?this.findMate(s):this.hunt(i),this.velocity=this.velocity.add(this.acceleration),this.velocity=this.velocity.limit(this.maxSpeed),this.position=this.position.add(this.velocity),this.acceleration=this.acceleration.mult(0),this.checkBoundaries(e,t)}applyForce(e){this.acceleration=this.acceleration.add(e)}hunt(e){let t=null,i=1/0;for(let s=0;s<e.length;s++){let a=this.position.dist(e[s]);a<this.senseRadius&&a<i&&(i=a,t=e[s])}t?this.seek(t):this.wander()}findMate(e){let t=null,i=1/0;for(let s of e){if(s===this)continue;let e=this.position.dist(s.position);e<this.senseRadius&&e<i&&s.reproUrge>200&&(i=e,t=s)}t?this.seek(t.position):this.wander()}seek(e){let t=e.sub(this.position).normalize().mult(this.maxSpeed).sub(this.velocity).limit(this.maxForce);this.applyForce(t)}wander(){let e=this.velocity.normalize().mult(50).add(this.position),t=Math.random()*Math.PI*2,i=20*Math.cos(t),a=20*Math.sin(t),o=e.add(new s(i,a));this.seek(o)}checkBoundaries(e,t){this.position.x<-this.size&&(this.position.x=e+this.size),this.position.x>e+this.size&&(this.position.x=-this.size),this.position.y<-this.size&&(this.position.y=t+this.size),this.position.y>t+this.size&&(this.position.y=-this.size)}reproduce(e,t=.05){if(this.reproUrge>200&&e.reproUrge>200&&this.energy>50&&e.energy>50){var i,s,o;let n;this.reproUrge=0,e.reproUrge=0,this.energy-=30,e.energy-=30;let r=(i=this.genome,s=e.genome,n={},Object.keys(i).forEach(e=>{"color"===e?n[e]=Math.random()>.5?i[e]:s[e]:(n[e]=Math.random()>.5?i[e]:s[e],Math.random()<t&&(n[e]=Math.max(0,Math.min(1,n[e]+(Math.random()-.5)*.2))))}),Math.random()<t&&(o=n.color,n.color=o),n);return new a(this.position.x,this.position.y,r)}return null}}class o{entities;food;effects;width;height;foodSpawnRate;mutationRate;constructor(e,t){this.width=e,this.height=t,this.entities=[],this.food=[],this.effects=[],this.foodSpawnRate=.5,this.mutationRate=.05,this.init()}init(){this.entities=[],this.food=[],this.effects=[];for(let e=0;e<20;e++)this.entities.push(new a(Math.random()*this.width,Math.random()*this.height));for(let e=0;e<50;e++)this.food.push(new s(Math.random()*this.width,Math.random()*this.height))}update(){Math.random()<this.foodSpawnRate&&this.food.push(new s(Math.random()*this.width,Math.random()*this.height));for(let e=this.effects.length-1;e>=0;e--)this.effects[e].age++,this.effects[e].age>=this.effects[e].maxAge&&this.effects.splice(e,1);let e=[];for(let t=this.entities.length-1;t>=0;t--){let i=this.entities[t];if(i.update(this.width,this.height,this.food,this.entities),i.isDead){this.effects.push({x:i.position.x,y:i.position.y,type:"death",age:0,maxAge:30,color:"rgba(255, 0, 0, 0.5)"}),this.entities.splice(t,1);continue}for(let e=this.food.length-1;e>=0;e--)i.position.dist(this.food[e])<i.size&&(this.food.splice(e,1),i.energy+=40);for(let t of this.entities)if(i!==t&&i.position.dist(t.position)<i.size+t.size){let s=i.reproduce(t,this.mutationRate);s&&(e.push(s),this.effects.push({x:s.position.x,y:s.position.y,type:"birth",age:0,maxAge:40,color:"rgba(255, 255, 255, 0.8)"}),this.effects.push({x:(i.position.x+t.position.x)/2,y:(i.position.y+t.position.y)/2,type:"mating",age:0,maxAge:20,color:"rgba(255, 105, 180, 0.6)"}))}}this.entities.push(...e)}}function n({onUpdate:e,onRestart:s}){let[a,o]=(0,i.useState)({foodSpawnRate:.5,mutationRate:.05,simulationSpeed:1}),n=(t,i)=>{let s={...a,[t]:i};o(s),e(s)};return(0,t.jsxs)("div",{className:"p-6 bg-pastel-surface rounded-xl shadow-lg shadow-indigo-100 text-pastel-text w-full",children:[(0,t.jsx)("h3",{className:"text-xl font-bold mb-6 text-pastel-primary",children:"Controls"}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium mb-2 text-gray-600",children:["Food Spawn Rate: ",a.foodSpawnRate.toFixed(2)]}),(0,t.jsx)("input",{type:"range",min:"0",max:"1",step:"0.01",value:a.foodSpawnRate,onChange:e=>n("foodSpawnRate",parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-pastel-accent"})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium mb-2 text-gray-600",children:["Mutation Rate: ",a.mutationRate.toFixed(2)]}),(0,t.jsx)("input",{type:"range",min:"0",max:"0.5",step:"0.01",value:a.mutationRate,onChange:e=>n("mutationRate",parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-pastel-primary"})]}),(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium mb-2 text-gray-600",children:["Sim Speed: ",a.simulationSpeed.toFixed(1),"x"]}),(0,t.jsx)("input",{type:"range",min:"0",max:"10",step:"0.1",value:a.simulationSpeed,onChange:e=>n("simulationSpeed",parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-pastel-secondary"})]}),(0,t.jsx)("button",{onClick:s,className:"w-full py-3 bg-pastel-primary hover:bg-indigo-300 text-white font-bold rounded-full transition-colors shadow-md hover:shadow-lg",children:"Restart Simulation"})]})}function r(){let e=(0,i.useRef)(null),s=(0,i.useRef)(null),a=(0,i.useRef)(null),[r,l]=(0,i.useState)({pop:0,food:0,avgSpeed:0}),h=(0,i.useRef)(1);return(0,i.useEffect)(()=>{let t;if(!e.current||!s.current)return;let i=s.current.clientWidth-340;e.current.width=i>400?i:400,e.current.height=600;let n=new o(e.current.width,600);a.current=n;let r=e.current.getContext("2d"),d=0,c=0,p=()=>{if(r){for(c+=h.current;c>=1;)n.update(),c-=1;for(let e of(r.fillStyle="#2d2b42",r.fillRect(0,0,n.width,n.height),r.fillStyle="#4ade80",n.food))r.beginPath(),r.arc(e.x,e.y,4,0,2*Math.PI),r.fill();for(let e of n.entities){r.fillStyle=e.genome.color,r.beginPath(),r.arc(e.position.x,e.position.y,e.size,0,2*Math.PI),r.fill();let t=e.position.x+e.velocity.normalize().x*(.7*e.size),i=e.position.y+e.velocity.normalize().y*(.7*e.size);r.fillStyle="white",r.beginPath(),r.arc(t,i,.3*e.size,0,2*Math.PI),r.fill()}for(let e of n.effects){let t=1-e.age/e.maxAge;r.save(),r.globalAlpha=t,"birth"===e.type?(r.beginPath(),r.arc(e.x,e.y,1.5*e.age,0,2*Math.PI),r.fillStyle=e.color,r.fill(),r.strokeStyle="white",r.lineWidth=2,r.stroke()):"death"===e.type?(r.beginPath(),r.arc(e.x,e.y,Math.max(0,20-.5*e.age),0,2*Math.PI),r.fillStyle=e.color,r.fill()):"mating"===e.type&&(r.beginPath(),r.arc(e.x,e.y,10+.5*e.age,0,2*Math.PI),r.fillStyle=e.color,r.fill()),r.restore()}if(++d%30==0){let e=n.entities.reduce((e,t)=>e+t.maxSpeed,0);l({pop:n.entities.length,food:n.food.length,avgSpeed:n.entities.length?e/n.entities.length:0})}t=requestAnimationFrame(p)}};return p(),()=>cancelAnimationFrame(t)},[]),(0,t.jsxs)("div",{ref:s,className:"w-full flex flex-col lg:flex-row gap-6",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col gap-6",children:[(0,t.jsxs)("div",{className:"flex gap-6 p-6 bg-pastel-surface rounded-xl shadow-lg shadow-indigo-100 text-pastel-text font-mono text-sm border border-indigo-50",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"Population"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-pastel-primary",children:r.pop})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"Food"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-pastel-accent",children:r.food})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-xs text-gray-400 uppercase tracking-wider",children:"Avg Speed"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-pastel-secondary",children:r.avgSpeed.toFixed(2)})]})]}),(0,t.jsx)("canvas",{ref:e,className:"rounded-xl shadow-2xl shadow-indigo-200 w-full"})]}),(0,t.jsx)("div",{className:"w-full lg:w-80",children:(0,t.jsx)(n,{onUpdate:e=>{a.current&&(a.current.foodSpawnRate=e.foodSpawnRate,a.current.mutationRate=e.mutationRate),h.current=e.simulationSpeed},onRestart:()=>{a.current&&a.current.init()}})})]})}e.s(["default",()=>r],85917)}]);